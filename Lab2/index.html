<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://acodedoer.github.io/CO1301/assets/style.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r126/three.min.js" integrity="sha512-n8IpKWzDnBOcBhRlHirMZOUvEq2bLRMuJGjuVqbzUJwtTsgwOgK5aS0c1JA647XWYfqvXve8k3PtZdzpipFjgg==" crossorigin="anonymous"></script>
    <script src="https://github.com/acodedoer/Test/blob/master/bundle.056cd6ff592ded82633f.js"></script>
    <!-- and it&#039;s easy to individually load additional languages -->
    <script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/go.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <title>CO1301 - Lab 2: Conditionals and Player Input</title>
    <style>
        .webgl {
            height: 30%;
        }

        .active{
           background-color: red;
        }
    </style>
</head>
<body>
    <header><h1>CO1301: Games Concepts <br> Lab 2 - Conditionals and Player Input</h1></header>
    <main>
        <section>
            <h2>1. Introduction</h2>
            <div class="section_instrcutions"></div>
                <ol>
                    <li>
                        <div class="list-div">
                            <span><p class= "instruction-item">
                                Last week we introduced the TL-Engine and used it to manipulate some simple 3D graphics. In this session you will learn about selection using "if" statements, and interacting with your program using mouse and keyboard input.
                            </p></span>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">
                                Rememeber that it is useful for you to keep a copy of the code you write so that you can reference or resue it in later programs.
                            </p>
                        </div>
                    </li>
                </ol>
            </div>
        </section>
        <section>
            <div>
                <h2>2. The "if" Statement</h2>
                <ol>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">Selection is the ability to execute code only if some condition is met. E.g. execute a block of code if the condition is true, or not executed a block of code if the condition is not true.               </p>
                       </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">In C++ you can exercise this control through the use of the word "if". The general form of an "if" statement is:
                           </p>
<pre><code class="plaintext">if (condition)
{
    // conditional exectution
}
</code></pre>
                       </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">The condition is a programming statement which equates to either true or false. Any expression which equates to a number can also be used.
                           </p>
                       </div>
                    </li><li >
                        <div class="list-div">
                             <p class= "instruction-item">The following are examples of the use of the if" statement: 
<pre><code>if ( a == b ) //if the firstVariable is equal to the secondVariable
{
    // do something
}
</code></pre>
<pre><code>if ( a != b ) //if the firstVariable is not equal to the secondVariable
{
    // do something
}
</code></pre>
<pre><code>if ( a < b ) //if the firstVariable is less than the secondVariable
{
    // do something
}
</code></pre>
<pre><code>if ( a > b ) //if the firstVariable is greater than the secondVariable
{
    // do something
}
</code></pre>
<pre><code>if ( myEngine->KeyHit( [KeyCode] )) //if the key with the provided keycode is hit
{
    //do something
}
</code></pre>
<pre><code>if (!myEngine->KeyHeld( [KeyCode] )) //if the key with the provided keycode is NOT held (notice the use of !)
{
    //do something
}
</code></pre>
<pre><code>if ( a + b < c) //if the sum of the firstVariable and secondVariable is less than the thirdVariable
{
    // do something
}
</code></pre>
<pre><code>if ( a * b > 100) //if the product of the firstVariable and secondVariable is greater than 100
{
    // do something
}
</code></pre>
                            </p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">Note that a conditional statement does not execute a command, but used to make decisions about executing commands.
                           </p>
                       </div>
                    </li>
                </ol>
            </div>
        </section>
        <section>
            <h2>3. Checking for Player Input</h2>
            <div class="section_introduction">
            </div>
            <div class="section_instrcutions">
                <ol>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">The 3D engine monitors the keyboard and mouse input for its own window. We can ask the engine if particular keys or mouse buttons have been pressed, the methods to do this are:
<pre><code class="plaintext">bool KeyHit( EKeyCode ); // Returns true when a given key or button is first pressed down.
// Example usage: if (myEngine->KeyHit( Key_A )) { Do something }


bool KeyHeld( EKeyCode ); // Returns true as long as a given key or button is held down.
// Example usage: if (myEngine->KeyHeld( Mouse_LButton )) { Do something }
</code></pre>
                            Note: The above code snippets show the method’s signatures – the return type of the method (bool in both cases), the method name (e.g. KeyHit), and the parameter type (EKeyCode). You should not copy the method signature into your program (otherwise the compiler will think you are trying to re-define the methods!).

                            When you call the methods, you can assign the result to a variable of the correct return type or, since the return type is bool, use the method call as the condition in an "if" statement, and you must pass in a parameter of the required type. The examples provided as comments show how the methods are used.
                             </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">You must supply a special key code to indicate which key (or button) you want to test ("Key_A" and "Mouse_Lbutton" were used in the examples above). The <a href="https://portal.uclan.ac.uk/bbcswebdav/pid-4281018-dt-content-rid-7932568_1/xid-7932568_1" target="_blank">full list of key codes can be found downloaded here.</a></p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Notice that mouse buttons are considered to be "keys" also.
                            </p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">There is a slight difference between the two input methods provided above. The first ("KeyHit") returns true once, when the key is first pressed, then it returns false until you let go of the key and press it again.
                           </p>
                       </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">The second method ("KeyHeld") will always return true as long as the key is held down. We will see how this difference is important soon.
                           </p>
                       </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">
                                Create a new TL-Engine project named <b>Lab2_Controls_Project</b>, open the project
                            </p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">
                                Add code to create an FPS camera, you may want to position it at ( 0, 0, -50 ). You should be able to do this without looking at last week's lab sheet. 
                            </p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">
                            Now add and display a cube in your scene (you should be able to do this without looking at lab 1 section 5), then try using the 'if' statement by typing the code below into the game loop section:</p>
<pre><code>if ( myEngine->KeyHeld( Mouse_RButton ))
{
    cube->MoveX( 0.05 );
}
else if ( myEngine->KeyHeld( Mouse_LButton ))
{
    cube->MoveX ( -0.05 );
}
</code></pre>
                                <p>This code tests if the right mouse button is held and moves the cube right, else if the left mouse button is held it moves the cube left. Run your project to test this out.
                            </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                                <p class= "instruction-item">Are you finding it difficult to keep the camera still while you move the cube with your mouse? Update your program to use a 'kManual' camera instead of a 'kFPS' by changing your camera creation code to the code below:</p>
<pre><code>ICamera* myCamera;
myCamera = myEngine->CreateCamera(kManual);
myCamera->SetPosition(0, 0, -50);
</code></pre>
                            <p>
                                This means the camera cannot be moved with the mouse anymore, so you will be able to easily move your cube with the click of mouse buttons.
                            </p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                                <p class= "instruction-item">Change the code you added to move your cube to use the ‘KeyHit’ method instead of 'KeyHeld'. Run you program - can you see the difference? Now change it back to 'KeyHeld'.</p>
                        </div>
                    </li>
                    <li>
                        <div class="list-div">
                            <p class= "instruction-item">
                            Add another 'if' statement by typing the code below into the game loop section:</p>
<pre><code class="plaintext">if ( myEngine->KeyHit( Key_Escape ))
{
    myEngine->Stop();
}
</code></pre>
                            <p>
                            This code tests if the escape key has been pressed and quits the engine (and program) if it has. You may want to add this to all your projects so you don’t need to use ‘Alt+F4’. Run your program and test quiting by pressing the escape key.
                            </p>
                        </div>
                    </li>
                </ol>
            </div>
        </section>
        <section>
            <div class="section_instrcutions">
                <h2>5. Keyboard Control</h2>
                <ol>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Change the code you added in the last section for moving your cube to move the cube right when you hold the ‘D’ key (instead of the right mouse button) and move left when the key ‘A’ is held (instead of the left mouse button).
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Now add code to move the cube forwards and backward (Z axis) with the keys ‘W’ and ‘S’.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Finally, add code to move the cube up and down (Y axis) with ‘Q’ and ‘E’.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">You can now fully control the movement of a model. Now we will see what happens when we control the rotation.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                                <p class= "instruction-item"><b>Now change your camera type back to kFPS, and remove the code for setting its position to (0, 0, -50).</b> Moving the camera can help in the tasks to follow.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Add a new “Grid.x” mesh and display a grid in your scene.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Change your code to load “Arrow.x” instead of “Cube.x” into the cubeMesh variable. You should now be able to see and control and arrow when you run your program.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Add code to rotate the arrow left and right when the keys ‘Z’ and ‘X’ are pressed (use the ‘RotateY’ method).</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">Run the program and rotate the arrow right about 45°. Now move it left and right with ‘A’ and ‘D’. Rotate it some more and try again. What do you notice about the direction that it moves?</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                             <p class= "instruction-item">What you should notice is that the arrow always moves left and right in the same direction: in the X direction of the large grid. This is called the ‘world’ X direction. Look closely at the arrow model and you can see it has its own grid, and it has its own X direction. This is called the arrow’s ‘local’ X direction. Sometimes you may want to move in the local directions, use the interactive scene below to understand the didrence between world and local directions.</p>
<!--         
                            <div class ="interactive-scene">
                                <canvas class="webgl"></canvas>
                                <div style="border: 2px solid black; padding: 0.3em; margin: 0.2em;">
                                    <div class="container">
                                        speed (less than 0.1)
                                        <input id ="speed" data-value type="number" value="0" />
                                    </div>
                                    <div class="container">
                                        RotateX
                                        <input id ="rotateX" data-value type="number" value="0" />
                                    </div>
                                    <div class="container">
                                        RotateY
                                        <input id ="rotateY" data-value type="number" value="0" />
                                    </div>
                                    <div class="container">
                                        RotateZ
                                        <input id ="rotateZ" data-value type="number" value="0" />
                                    </div>
                                </div>
                                
                                <div style="border: 2px solid black; padding: 0.3em;margin: 0.2em;">
                                    <div class="container">
                                        <button id="moveX">MoveX</button>
                                    </div>
                                    <div class="container">
                                        <button id="moveLocalX" >MoveLocalX</button>
                                    </div>
                                    <div class="container">
                                        <button id="moveY">MoveY</button>
                                    </div>
                                    <div class="container">
                                        <button id="moveLocalY" >MoveLocalY</button>
                                    </div>
                                    <div class="container">
                                        <button id="moveZ">MoveZ</button>
                                    </div>                                
                                    <div class="container">
                                        <button id="moveLocalZ" >MoveLocalZ</button>
                                    </div>
                                    <div class="container">
                                        <button id="resetPosition" >Reset Position</button>
                                    </div>
                                    <div class="container">
                                        <button id="stopMovement" >Stop Movement</button>
                                    </div>
                                </div>
                            </div>
                            <br> -->
                            <p>The TL-Engine provides methods for moving in the local x, y, and z directions:</p>
<pre><code>void MoveLocalX(const float);
void MoveLocalY(const float);
void MoveLocalZ(const float);
</code></pre>
                            <p>To move an IModel named arrow along its local x for example, the code below should be used:</p>
                            <pre><code>arrow->MoveLocalX( 0.1 );                            </code></pre>

                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                                <p class= "instruction-item">Change all the ‘Move’ methods from the previous exercises to ‘MoveLocal’ methods (see above example). Now experiment with rotation and movement together. Can you see the difference?</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                                <p class= "instruction-item">Save your project, make sure it is stored where you can access it as you will need it in the next lab.</p>
                        </div>
                    </li>
                </ol>
            </div>
        </section>
        <section>
            <h2>6. Working with Variables</h2>
            <div class="section_instrcutions">
                <ol>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Create a new TL-Engine project named <b>Lab2_TestingVariables_Project</b>. If you have completed week 1's Advanced Movement exercise, you can resue your code in completing the tasks below.
                            </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Load the cube mesh and then create a cube model.
                            </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Declare a variable of type float in the initialisation section (before the game loop) and name it cubeSpeed. Assign an appropriate value to cubeSpeed.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item"> Move the cube to the right using the variable you just created. Use the code below:
                            <pre><code>cube->MoveX( cubeSpeed );</code></pre>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">You can obtain the current location of a model. For instance, you can obtain the current x coordinate of the cube by using:
                            <pre><code>xCoordinate = cube->GetX();</code></pre>
                            Note that I have used a new variable to store the location of the cube. This new variable is called xCoordinate. The GetX() function returns a value. In other words, it passes a value back and this value can either be used directly or assigned to a variable.
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Now get the cube to stop moving when it reaches 40 along the x axis, i.e. when GetX( ) returns a value of 40.</p>
                            <p>
                            Hint: You will have to declare a variable to store the value returned by GetX() and you will have to use the if statement to check it.</p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Replace the cube displayed in your program with a sphere. 
                            </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Then update your code so that the sphere bounces from left to right between x = -40 and x = 40. Use a variable to determine the direction of movement.
                            </p>
                        </div>
                    </li>
                    <li >
                        <div class="list-div">
                            <p class= "instruction-item">Can you make the sphere roll while it bounces?
                            </p>
                        </div>
                    </li>
                </ol>
            </div>
        </section>
        <section>
            <h2>7. Pause and Reverse</h2>
            <ol>
                <li >
                    <div class="list-div">
                        <p class= "instruction-item">Expand your project so you can use the keyboard in the following way:
                            <ul>
                                <li>Whenever the ‘R’ key is pressed, the sphere changes direction.</li>
                                <li>The ‘P’ key acts as a pause button for your “game”.</li>
                            </ul>
                        </p>
                        <p class= "instruction-item">
                        Hints:
                        <ul>
                            <li>You will need a variable to implement the pause button.</li>
                            <li>You will need to use selection to to check the state of your variable</li>
                        </ul> 
                        </p>
                    </div>
                </li>
            </ol>
        </section>
    </main>
    <script src="https://acodedoer.github.io/CO1301/assets/script.js"></script>
    <script>
            const canvas = document.querySelector('canvas.webgl')
            const loadingManager = new THREE.LoadingManager()
            const textureLoader = new THREE.TextureLoader(loadingManager);
            const planeXZTexture = textureLoader.load('https://acodedoer.github.io/CO1301/Lab1/Grid.jpg')
            const planeYTexture = textureLoader.load('https://acodedoer.github.io/CO1301/Lab1/Grid2.jpg')
            const boxTexture = textureLoader.load('https://acodedoer.github.io/CO1301/Lab1/tiles1.jpg')

            const scene = new THREE.Scene();

            const planeYGeometry = new THREE.PlaneBufferGeometry(1,3, 1);
            const planeYMaterial = new THREE.MeshBasicMaterial({map:planeYTexture, transparent:false});
            const planeYMesh = new THREE.Mesh(planeYGeometry, planeYMaterial);
            planeYMesh.position.set(0,1.5,0);


            const planeXZGeometry = new THREE.PlaneBufferGeometry(6,6, 1);
            const planeXZMaterial = new THREE.MeshBasicMaterial({map:planeXZTexture});
            planeYMaterial.opacity = 0.5;
            const planeXZMesh = new THREE.Mesh(planeXZGeometry, planeXZMaterial);
            planeXZMesh.rotation.set(-Math.PI/2, 0, 0)

            const cube = new THREE.BoxBufferGeometry(1,1, 1);
            const cube_material = new THREE.MeshBasicMaterial({map:boxTexture, wireframe:false});
            const cube_mesh = new THREE.Mesh(cube, cube_material);
            cube_mesh.scale.set(0.5, 0.5, 0.5)
            const size = {
                width: window.innerWidth/3,
                height: window.innerWidth/3
            }
            const camera = new THREE.PerspectiveCamera(75, size.width/size.height);
            camera.position.set(5, 5, 10);
            camera.rotation.set(0, 3.14/8, 0);
            scene.add(cube_mesh, planeXZMesh, planeYMesh)
            const renderer = new THREE.WebGLRenderer(
                {canvas: canvas}
            );
            renderer.setSize(size.width, size.height)
            renderer.setClearColor("")

            const parameters = {
                color: 0xff0000,
                toRight: ()=>{gsap.to(cube_mesh.position, {duration: 1, delay: 0, x:4})},
                toLeft: ()=>{gsap.to(cube_mesh.position, {duration: 1, delay: 0, x:-4})},
            }
            let activeBtn = undefined;
            let btns = document.querySelector('button')
            let movement = undefined;
            let speed = 0;
            let xrot = 0;
            let yrot = 0;
            let zrot = 0;

            document.getElementById("speed").addEventListener("change", (e)=>{
               speed=e.srcElement.value;
            })

            document.getElementById("rotateX").addEventListener("change", (e)=>{
              xrot = e.srcElement.value * Math.PI/180;
              setRotation()
            })
            document.getElementById("rotateY").addEventListener("change", (e)=>{
              yrot = e.srcElement.value * Math.PI/180;
              setRotation()
            })
            document.getElementById("rotateZ").addEventListener("change", (e)=>{
              zrot = e.srcElement.value * Math.PI/180;
              setRotation()
            })

            const setRotation = () =>{
                cube_mesh.rotation.set(xrot, yrot, zrot)
            }

            document.getElementById("moveX").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "wx")
            })

            document.getElementById("moveLocalX").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "lx")
            })

            document.getElementById("moveY").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "wy")
            })

            document.getElementById("moveLocalY").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "ly")
            })
            document.getElementById("resetPosition").addEventListener("click", (e)=>{
                cube_mesh.position.set(0,0,0)
            })

            document.getElementById("stopMovement").addEventListener("click", (e)=>{
                movement=""
                activeBtn.className=""
                activeBtn=undefined
            })

            document.getElementById("moveZ").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "wz")
            })

            document.getElementById("moveLocalZ").addEventListener("click", (e)=>{
                updateBtn(e.srcElement, "lz")
            })

            updateBtn = (src, mvmt) =>{
                console.log(src)
                if(activeBtn!=undefined) activeBtn.className=""
                activeBtn = src;
                activeBtn.className = "active";
                movement = mvmt;
                
            }
            const x_axis = new THREE.Vector3( 1, 0, 0 );
            const y_axis = new THREE.Vector3( 0, 1, 0 );
            const z_axis = new THREE.Vector3( 0, 0, 1 );

            const tick = () =>{
                renderer.render(scene, camera);
                window.requestAnimationFrame(tick)
                if(activeBtn!=undefined){
                    console.log(activeBtn)
                    console.log(movement)
                    if(movement=="wx"){
                        cube_mesh.translateX(speed)
                    }
                    else if(movement=="lx"){
                        cube_mesh.translateOnAxis(cube_mesh.worldToLocal(x_axis), speed)
                    }
                    if(movement=="wy"){
                        cube_mesh.translateY(speed)
                    }
                    else if(movement=="ly"){
                        cube_mesh.translateOnAxis(cube_mesh.worldToLocal(y_axis), speed)
                    }
                    if(movement=="wz"){
                        cube_mesh.translateZ(speed)
                    }
                    else if(movement=="lz"){
                        cube_mesh.translateOnAxis(cube_mesh.worldToLocal(z_axis), speed)
                    }
                }
            }

            tick()

        </script>
</body>
</html>